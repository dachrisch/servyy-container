# Traefik bot/scanner filter for fail2ban
# Blocks known malicious user agents and scanner patterns
# Managed by Ansible

[Definition]

# Match known scanner/bot user agents
failregex = ^<HOST> .* "(curl|wget|python-requests|nikto|sqlmap|nmap|masscan|zgrab|nuclei|Go-http-client|Java/|dirbuster|gobuster|feroxbuster|ffuf|wfuzz).*".*$
            ^<HOST> .* ".*" .* ".*[Ss]qlmap.*"$
            ^<HOST> .* ".*" .* ".*[Nn]ikto.*"$
            ^<HOST> .* ".*" .* ".*[Nn]map.*"$
            ^<HOST> .* ".*" .* ".*[Mm]asscan.*"$
            ^<HOST> .* ".*" .* ".*[Zz]grab.*"$
            ^<HOST> .* ".*" .* ".*[Nn]uclei.*"$

# Match vulnerability scanning patterns in URLs
            ^<HOST> .* "(GET|POST|PUT|DELETE) .*(\.php|\.asp|\.env|wp-admin|wp-login|phpmyadmin|xmlrpc|/admin|/config|\.git|\.svn|\.bak|\.sql|passwd|shadow).*".*$
            ^<HOST> .* "(GET|POST|PUT|DELETE) .*(\.\./|%2e%2e|etc/passwd|etc/shadow|proc/self).*".*$
            ^<HOST> .* "(GET|POST|PUT|DELETE) .*(union.*select|<script|javascript:|eval\(|exec\().*".*$

ignoreregex =

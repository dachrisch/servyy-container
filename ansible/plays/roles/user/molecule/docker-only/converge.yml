---
- name: Converge (User Docker-Only)
  hosts: all
  become: true
  become_user: testuser
  vars:
    create_user: testuser
    with_docker: true
    with_containers: true
    check_git_servyy_reachable: false
    extension_drive:
      path: /mnt/mock_volume
      device: /dev/null
      fstype: ext4
      opts: discard,defaults
  tasks:
    - name: Run docker_setup tasks  # noqa: role-name[path]
      ansible.builtin.include_role:
        name: "{{ playbook_dir }}/../../"
        tasks_from: docker_setup
      when: (with_docker or with_containers) | default(false)
      tags: [user.docker.setup]

    # Skip: repository cloning (requires git.lehel.xyz), docker_services (requires compose files),
    # dns tasks, backup, restic, host_ping
